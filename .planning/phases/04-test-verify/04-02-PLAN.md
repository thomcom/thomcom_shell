---
phase: 04-test-verify
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified: []
autonomous: false
must_haves:
  truths:
    - "test_suite.sh runs and all tests pass"
    - "zbc broadcasts to other terminals"
    - "Session logging creates log files"
    - "Interactive features load correctly"
  artifacts: []
  key_links:
    - from: "tests/test_suite.sh"
      to: "bashrc"
      via: "source in subshell"
      pattern: "source.*bashrc"
---

<objective>
Run the test suite and verify all bash functionality works end-to-end.

Purpose: Confirm the entire migration is working - tests pass, broadcast works, session logging works.
Output: Verified working bash shell configuration.
</objective>

<execution_context>
@/home/devkit/.claude/get-shit-done/workflows/execute-plan.md
@/home/devkit/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-test-verify/04-01-SUMMARY.md
@tests/test_suite.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run test suite and fix any failures</name>
  <files></files>
  <action>
Run `bash tests/test_suite.sh` from the repo root.

If any tests fail, diagnose and fix the underlying issue in the shell config files (not the tests - those were fixed in plan 01). Common issues:
- Source path problems (bashrc not finding modules)
- Environment variables not exported
- Functions not available in subshells

Iterate until all 6 tests pass. If a config file needs fixing, fix it and re-run.
  </action>
  <verify>bash tests/test_suite.sh shows all SUCCESS, zero FAIL</verify>
  <done>All 6 tests pass</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Manual verification of key features</name>
  <what-built>Complete bash migration - all shell modules converted, installer updated, tests passing</what-built>
  <how-to-verify>
1. Open a new terminal: does bash prompt load correctly?
2. Run `type zbc` - should show it as a function
3. Open a second terminal, run `zbc "echo hello from broadcast"` in the first - second terminal should execute it on next prompt
4. Check `ls ~/data/terminal-sessions/` - should have session log files
5. Run `echo $THOMCOM_SECRETS_DIR` - should show ~/.nvidia
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
- test_suite.sh runs with all tests passing
- User confirms broadcast, session logging, and environment work
</verification>

<success_criteria>
All automated tests pass. User confirms interactive features work in real terminal.
</success_criteria>

<output>
After completion, create `.planning/phases/04-test-verify/04-02-SUMMARY.md`
</output>
